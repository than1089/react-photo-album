(this["webpackJsonpredux-typescript"]=this["webpackJsonpredux-typescript"]||[]).push([[0],{10:function(e,t,a){e.exports={photos:"Photos_photos__361YJ",photo:"Photos_photo__2-z8c",photoHolder:"Photos_photoHolder__3t51Y",photoName:"Photos_photoName__3bVJy",selectedPhoto:"Photos_selectedPhoto__1P1x2"}},29:function(e,t,a){e.exports=a(59)},34:function(e,t,a){},35:function(e,t,a){},59:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(11),c=a.n(r),l=(a(34),a(9)),s=(a(35),a(28)),i=a(27),u=a(5),d=a(2),p=a.n(d),h=a(4),m=a(8),f=a(12),v=a.n(f),g=Object({NODE_ENV:"production",PUBLIC_URL:"/react-photo-album",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_BACKEND_URL||"https://tn-album-backend.herokuapp.com";function b(){return(b=Object(h.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get("".concat(g,"/health"));case 2:return t=e.sent,a=t.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=Object(h.a)(p.a.mark((function e(){var t,a,n,o,r=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:0,a=r.length>1&&void 0!==r[1]?r[1]:5,e.next=4,v.a.post("".concat(g,"/photos/list"),{skip:t,limit:a});case 4:return n=e.sent,o=n.data,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=Object(h.a)(p.a.mark((function e(t,a){var n,o,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.values(a).filter((function(e){return-1!==t.indexOf(e.id)})),o={},n.forEach((function(e){o[e.album]?o[e.album].push(e.name):o[e.album]=[e.name]})),r=Object.entries(o).map((function(e){return{album:e[0],documents:e[1].join(", ")}})),e.next=6,fetch("".concat(g,"/photos"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 6:return c=e.sent,e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(h.a)(p.a.mark((function e(t,a,n){var o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new FormData,t.forEach((function(e){o.append("documents",e)})),o.append("album",a),e.next=5,v.a.put("".concat(g,"/photos"),o,{onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);n(C(t))}});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var _={healCheck:function(){return b.apply(this,arguments)},getPhotos:function(){return E.apply(this,arguments)},uploadPhotos:function(e,t,a){return O.apply(this,arguments)},deletePhotos:function(e,t){return P.apply(this,arguments)}},k=Object(m.b)({name:"upload",initialState:{percentage:0,isUploading:!1,error:null},reducers:{uploadPhotosStart:function(e){e.isUploading=!0},uploadPhotosSuccess:function(e){e.isUploading=!1},uploadPhotosFailure:function(e,t){var a=t.payload;e.isUploading=!1,e.error=a},setUploadPercentage:function(e,t){var a=t.payload;e.percentage=a}}}),y=k.actions,S=y.uploadPhotosStart,j=y.uploadPhotosSuccess,w=y.uploadPhotosFailure,C=y.setUploadPercentage,x=k.reducer,N=a(7),U=a.n(N),F={borderColor:"#2196f3"},I={borderColor:"#00e676"},L={borderColor:"#ff1744"},M=["Travel","Personal","Food","Nature","Other"];function z(e){var t=Object(u.b)(),a=Object(n.useState)([]),r=Object(l.a)(a,2),c=r[0],d=r[1],m=Object(n.useState)(""),f=Object(l.a)(m,2),v=f[0],g=f[1],b=Object(n.useState)(!1),E=Object(l.a)(b,2),P=E[0],O=E[1],k=Object(u.c)((function(e){return e.upload})),y=Object(i.a)({accept:"image/*",onDrop:function(e){d(e)}}),C=y.getRootProps,x=y.getInputProps,N=y.isDragActive,z=y.isDragAccept,D=y.isDragReject,B=Object(n.useMemo)((function(){return Object(s.a)({},N?F:{},{},z?I:{},{},D?L:{})}),[N,D,z]);return Object(n.useEffect)((function(){k.isUploading||100!==k.percentage||(O(!0),d([]))}),[k.isUploading,k.percentage]),o.a.createElement("div",null,o.a.createElement("div",{className:U.a.modalOverlay}),o.a.createElement("div",{className:U.a.modalContent},o.a.createElement("div",{className:U.a.modalHeader},o.a.createElement("h3",null,"Upload Photos"),o.a.createElement("a",{href:"#!",onClick:e.onClose},"X")),o.a.createElement("div",Object.assign({},C({style:B}),{className:U.a.dropzone}),o.a.createElement("input",x()),o.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files")),o.a.createElement("div",null,!c.length&&!P&&o.a.createElement("p",{className:"text-center"},"No files selected..."),!c.length&&P&&o.a.createElement("p",{className:"text-center"},"Uploaded successfully."),!!c.length&&o.a.createElement("ul",null,c.map((function(e,t){return o.a.createElement("li",{key:t},o.a.createElement("span",null,e.name),o.a.createElement("a",{href:"#!",onClick:function(){return function(e){var t=c.slice();t.splice(e,1),d(t)}(t)},className:U.a.removeFile},"X"))}))),k.isUploading&&o.a.createElement("div",{className:U.a.progress},o.a.createElement("div",{className:U.a.percentage,style:{width:"".concat(k.percentage,"%")}}))),o.a.createElement("div",{className:U.a.modalFooter},o.a.createElement("select",{name:"album",onChange:function(e){return g(e.target.value)}},o.a.createElement("option",{value:""},"Select Album"),M.map((function(e){return o.a.createElement("option",{value:e,key:e},e)}))),o.a.createElement("button",{onClick:function(){return t(function(e,t){return function(){var a=Object(h.a)(p.a.mark((function a(n){return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n(S()),a.next=4,_.uploadPhotos(e,t,n);case 4:n(j()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),n(w(a.t0.toString()));case 10:case"end":return a.stop()}}),a,null,[[0,7]])})));return function(e){return a.apply(this,arguments)}}()}(c,v))},className:U.a.button,disabled:!v||!c.length},o.a.createElement("img",{src:"/react-photo-album/upload-icon.png",width:"15",alt:"Upload Icon"})," Upload"))))}function D(e){e.isLoading=!0}function B(e,t){e.isLoading=!1,e.error=t.payload}var H=Object(m.b)({name:"photos",initialState:{photosById:{},total:0,size:10,selectedIds:[],isLastPage:!0,isLoading:!1,error:null},reducers:{getPhottosStart:D,uploadPhotosStart:D,deletePhotosStart:D,getPhotosSuccess:function(e,t){var a=t.payload,n=a.documents,o=a.count,r=a.limit;e.isLoading=!1,e.error=null,n.forEach((function(t){e.photosById[t.id]=t})),e.total=Object.keys(e.photosById).length,e.isLastPage=o<r},resetPhotos:function(e){e.photosById={}},deletePhotosSuccess:function(e,t){t.payload.forEach((function(t){return delete e.photosById[t]})),e.selectedIds=[],e.isLoading=!1},getPhottosFailure:B,uploadPhotosFailure:B,deletePhotosFailure:B,setPageSize:function(e,t){var a=t.payload;e.size=a},selectPhoto:function(e,t){var a=t.payload,n=e.selectedIds.indexOf(a);-1===n?e.selectedIds.push(a):e.selectedIds.splice(n,1)}}}),T=H.actions,A=T.getPhottosStart,R=(T.uploadPhotosStart,T.deletePhotosStart),W=T.getPhotosSuccess,J=T.deletePhotosSuccess,K=T.getPhottosFailure,X=(T.uploadPhotosFailure,T.deletePhotosFailure),V=T.setPageSize,Y=T.resetPhotos,q=T.selectPhoto,G=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(){var n=Object(h.a)(p.a.mark((function n(o){var r;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o(A()),n.next=4,_.getPhotos(e,t);case 4:r=n.sent,a&&o(Y()),o(W(r)),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),o(K(n.t0.toString()));case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()},Q=H.reducer,$=a(10),Z=a.n($);function ee(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e.photos}));Object(n.useEffect)((function(){e(G(0,t.size,!0))}),[e,t.size]);return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:Z.a.photos},Object.values(t.photosById).map((function(a){return o.a.createElement("div",{key:a.id,className:Z.a.photo+(n=a.id,-1!==t.selectedIds.indexOf(n)?" ".concat(Z.a.selectedPhoto):""),onClick:function(){return e(q(a.id))}},o.a.createElement("div",{className:Z.a.photoHolder},o.a.createElement("img",{src:a.raw,alt:a.name})),o.a.createElement("div",{className:Z.a.photoName},o.a.createElement("span",null,a.name)),o.a.createElement("small",null,a.album));var n}))),!t.isLastPage&&o.a.createElement("div",{className:"load-more text-center"},o.a.createElement("button",{className:"load-more-btn",onClick:function(){e(G(t.total,t.size,!1))}},"Load More")),t.isLoading&&o.a.createElement("div",{className:"text-center"},o.a.createElement("img",{src:"/react-photo-album/loading.gif",width:"50",alt:"loading"})))}var te=Object(m.b)({name:"health",initialState:{ok:!0,isChecking:!1},reducers:{healthCheckStart:function(e){e.isChecking=!0},healthCheckSuccess:function(e){e.isChecking=!1,e.ok=!0},healthCheckFailure:function(e,t){e.isChecking=!1,e.ok=!1}}}),ae=te.actions,ne=ae.healthCheckStart,oe=ae.healthCheckSuccess,re=ae.healthCheckFailure,ce=te.reducer;var le=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],r=t[1],c=Object(u.b)();Object(n.useEffect)((function(){c(function(){var e=Object(h.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(ne()),e.next=4,_.healCheck();case 4:a=e.sent,t("OK"===a?oe():re(a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t(re(e.t0.toString()));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())}),[c]);var s=Object(u.c)((function(e){return e.photos})),i=Object(u.c)((function(e){return e.health}));return o.a.createElement("div",{className:"app"},i.ok&&o.a.createElement(o.a.Fragment,null,o.a.createElement("header",{className:"app-header"},o.a.createElement("h1",null,"Photos"),o.a.createElement("div",{className:"actions"},!!s.selectedIds.length&&o.a.createElement(o.a.Fragment,null,o.a.createElement("a",{href:"#!",onClick:function(){var e,t;window.confirm("Are you sure you want to delete the selected photos?")&&c((e=s.selectedIds,t=s.photosById,function(){var a=Object(h.a)(p.a.mark((function a(n){return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n(R()),a.next=4,_.deletePhotos(e,t);case 4:n(J(e)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),n(X(a.t0.toString()));case 10:case"end":return a.stop()}}),a,null,[[0,7]])})));return function(e){return a.apply(this,arguments)}}()))}},o.a.createElement("button",null,"Delete ",s.selectedIds.length," photos")),o.a.createElement("span",null,"|")),o.a.createElement("a",{href:"#!",onClick:function(){return r(!0)}},o.a.createElement("img",{src:"/react-photo-album/upload-icon.png",width:"20",alt:"Upload"})),o.a.createElement("span",null,"|"),o.a.createElement("select",{onChange:function(e){c(V(Number(e.target.value)))},value:s.size,title:"Page Size"},o.a.createElement("option",{value:"5"},"5"),o.a.createElement("option",{value:"10"},"10"),o.a.createElement("option",{value:"25"},"25"),o.a.createElement("option",{value:"50"},"50"),o.a.createElement("option",{value:"100"},"100")))),a&&o.a.createElement(z,{onClose:function(){return r(!1)}}),o.a.createElement(ee,null)),!i.ok&&o.a.createElement("h2",{className:"text-center"},"Something went wrong! Please try again later!"))},se=Object(m.a)({reducer:{photos:Q,upload:x,health:ce}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(u.a,{store:se},o.a.createElement(le,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,a){e.exports={modalContent:"UploadModal_modalContent__b8enW",modalOverlay:"UploadModal_modalOverlay__1qM5G",modalHeader:"UploadModal_modalHeader__10kvO",modalFooter:"UploadModal_modalFooter__7fNIf",dropzone:"UploadModal_dropzone__2wd05",button:"UploadModal_button__2gmAi",removeFile:"UploadModal_removeFile__PFdyX",progress:"UploadModal_progress__19HHn",percentage:"UploadModal_percentage__1PQst"}}},[[29,1,2]]]);
//# sourceMappingURL=main.0526de71.chunk.js.map